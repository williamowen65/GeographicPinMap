<!DOCTYPE html>
<button>Add Location</button>
<div id="container"></div>
<script type="module">
  import * as d3 from 'https://cdn.jsdelivr.net/npm/d3@7/+esm'

  // Declare the chart dimensions and margins.
  const width = 960
  const height = 600

  // Create the SVG container.
  const svg = d3
    .select('#container')
    .append('svg')
    .attr('width', width)
    .attr('height', height)

  // Define a projection.
  const projection = d3
    .geoOrthographic()
    .scale(300)
    .translate([width / 2, height / 2])
    .clipAngle(90)
  // Create a blue circle behind the earth.
  svg
    .append('circle')
    .attr('cx', width / 2)
    .attr('cy', height / 2)
    .attr('r', projection.scale())
    .attr('fill', 'blue')
  // Define a path generator.
  const path = d3.geoPath().projection(projection)

  // Load and display the world map.
  d3.json(
    'https://raw.githubusercontent.com/holtzy/D3-graph-gallery/master/DATA/world.geojson'
  ).then(function (data) {
    svg
      .append('g')
      .selectAll('path')
      .data(data.features)
      .enter()
      .append('path')
      .attr('d', path)
      .attr('fill', '#69b3a2')
      .attr('stroke', '#fff')
  })

  // Set up rotation parameters.
  let rotate = [0, 0]
  const velocity = 0.02

  // Function to update the rotation.
  function updateRotation() {
    rotate[0] += velocity
    projection.rotate(rotate)
    svg.selectAll('path').attr('d', path)
    requestAnimationFrame(updateRotation)
  }

  // Start the rotation.
  updateRotation()
</script>
